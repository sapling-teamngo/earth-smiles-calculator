<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Earth Smiles Calculator - Sustainable Water Harvesting</title>
    <link rel="stylesheet" href="css/style.css">
    <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css" />
    <script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"></script>
</head>
<body>
    <header>
        <nav>
            <div class="logo">üåç Earth Smiles Calculator</div>
            <ul>
                <li><a href="#" onclick="showSection('home')">Home</a></li>
                <li><a href="#" onclick="showSection('calculator')">Calculator</a></li>
                <li><a href="documentation.html">Documentation</a></li>
                <li><a href="research.html">Research</a></li>
                <li><a href="ar.html">ÿßŸÑÿπÿ±ÿ®Ÿäÿ©</a></li>
            </ul>
        </nav>
    </header>

    <main>
        <section id="home" class="section active">
            <div class="hero">
                <h1>Earth Smiles Calculator</h1>
                <p>Design optimal semicircular bunds for water harvesting and soil conservation using WOCAT methodology</p>
                <button class="cta-button" onclick="showSection('calculator')">Start Calculation</button>
            </div>
            <div class="features">
                <div class="feature-card">
                    <h3>WOCAT Based</h3>
                    <p>Using proven methodologies from World Overview of Conservation Approaches and Technologies</p>
                </div>
                <div class="feature-card">
                    <h3>Scientific Design</h3>
                    <p>Accurate calculations based on rainfall, slope, and soil parameters</p>
                </div>
                <div class="feature-card">
                    <h3>Multi-Language</h3>
                    <p>Available in English and Arabic for wider accessibility</p>
                </div>
            </div>
        </section>

        <section id="calculator" class="section">
            <div class="calculator-container">
                <div class="progress-bar">
                    <div class="step active" data-step="1">Area Input</div>
                    <div class="step" data-step="2">Climate Data</div>
                    <div class="step" data-step="3">Results</div>
                    <div class="step" data-step="4">Visualization</div>
                </div>

                <!-- Step 1: Area Input -->
                <div class="step-content active" id="step1-content">
                    <h2>Step 1: Define Your Area</h2>
                    <div class="input-methods">
                        <div class="method-card" onclick="selectMethod('map')">
                            <h3>üó∫Ô∏è Map Selection</h3>
                            <p>Click points on map to define polygon</p>
                        </div>
                        <div class="method-card" onclick="selectMethod('manual')">
                            <h3>üìù Manual Input</h3>
                            <p>Enter coordinates manually</p>
                        </div>
                        <div class="method-card" onclick="selectMethod('simple')">
                            <h3>üìê Simple Input</h3>
                            <p>Enter area and slope directly</p>
                        </div>
                    </div>

                    <div id="map-container" class="method-content hidden">
                        <h3>Click on map to create polygon</h3>
                        <div id="map" style="height: 400px; width: 100%; margin: 20px 0;"></div>
                        <div class="button-group">
                            <button onclick="clearMap()">Clear</button>
                            <button onclick="calculateAreaFromMap()">Calculate Area & Slope</button>
                        </div>
                    </div>

                    <div id="manual-input" class="method-content hidden">
                        <h3>Enter Coordinates (Latitude, Longitude)</h3>
                        <div id="coordinate-inputs">
                            <div class="coord-pair">
                                <input type="number" class="coord-lat" placeholder="Latitude" step="any">
                                <input type="number" class="coord-lng" placeholder="Longitude" step="any">
                                <button onclick="removeCoordinate(this)">Remove</button>
                            </div>
                        </div>
                        <div class="button-group">
                            <button onclick="addCoordinate()">Add Coordinate</button>
                            <button onclick="calculateAreaFromCoords()">Calculate Area & Slope</button>
                        </div>
                    </div>

                    <div id="simple-input" class="method-content hidden">
                        <h3>Direct Input</h3>
                        <div class="input-group">
                            <label>Total Area (hectares):</label>
                            <input type="number" id="total-area" step="0.1" min="0.1" value="1.0">
                        </div>
                        <div class="input-group">
                            <label>Average Slope (%):</label>
                            <input type="number" id="avg-slope" step="0.1" min="0" max="60" value="5.0">
                        </div>
                        <button onclick="proceedToStep2()">Next</button>
                    </div>

                    <div id="step1-results" class="method-content hidden">
                        <h3>‚úÖ Area Analysis Complete</h3>
                        <div class="results">
                            <p>Total Area: <span id="calculated-area">0</span> hectares</p>
                            <p>Average Slope: <span id="calculated-slope">0</span>%</p>
                            <p>Slope Classification: <span id="slope-class">Flat</span></p>
                        </div>
                        <button onclick="proceedToStep2()">Continue to Step 2</button>
                    </div>
                </div>

                <!-- Step 2: Climate Data -->
                <div class="step-content" id="step2-content">
                    <h2>Step 2: Climate & Soil Data</h2>
                    <form id="climate-form">
                        <div class="form-group">
                            <label for="rainfall">Annual Rainfall (mm):</label>
                            <input type="number" id="rainfall" required min="100" max="3000" value="1025">
                            <small>Source: WOCAT Benin data shows 1025mm average. Adjust for your region.</small>
                        </div>
                        <div class="form-group">
                            <label for="soil-type">Soil Type:</label>
                            <select id="soil-type">
                                <option value="sandy">Sandy (Coarse/Light)</option>
                                <option value="loamy" selected>Loamy (Medium)</option>
                                <option value="clay">Clay (Fine/Heavy)</option>
                            </select>
                        </div>
                        <div class="form-group">
                            <label for="land-use">Land Use:</label>
                            <select id="land-use">
                                <option value="orchard">Fruit Orchard (Citrus, Cashew)</option>
                                <option value="pasture">Pasture Rehabilitation</option>
                                <option value="cropland">Cropland</option>
                            </select>
                        </div>
                        <div class="form-group">
                            <label for="organic-matter">Organic Matter Content:</label>
                            <select id="organic-matter">
                                <option value="low">Low (&lt;1%)</option>
                                <option value="medium" selected>Medium (1-3%)</option>
                                <option value="high">High (&gt;3%)</option>
                            </select>
                        </div>
                        <div class="button-group">
                            <button type="button" onclick="showSection('calculator', 1)">Back</button>
                            <button type="button" onclick="calculateDesign()">Calculate Design</button>
                        </div>
                    </form>
                </div>

                <!-- Step 3: Results -->
                <div class="step-content" id="step3-content">
                    <h2>Step 3: Earth Smile Design Results</h2>
                    <div id="results-container" class="results-grid"></div>
                    <div class="button-group">
                        <button onclick="showSection('calculator', 2)">Back</button>
                        <button onclick="proceedToStep4()">View Visualization</button>
                    </div>
                </div>

                <!-- Step 4: Visualization -->
                <div class="step-content" id="step4-content">
                    <h2>Step 4: Design Visualization</h2>
                    <div id="visualization-container">
                        <div class="viz-controls">
                            <label>View: </label>
                            <select id="view-type" onchange="updateVisualization()">
                                <option value="single">Single Structure</option>
                                <option value="layout">Field Layout</option>
                                <option value="cross-section">Cross Section</option>
                            </select>
                        </div>
                        <canvas id="design-canvas" width="800" height="400"></canvas>
                        <div id="layout-info" class="layout-details"></div>
                    </div>
                    <div class="button-group">
                        <button onclick="showSection('calculator', 3)">Back</button>
                        <button onclick="generateReport()">Generate Project Report</button>
                        <button onclick="resetCalculator()">New Calculation</button>
                    </div>
                </div>
            </div>
        </section>
    </main>

    <footer>
        <p>&copy; 2024 Earth Smiles Calculator. Based on WOCAT methodologies.</p>
        <p>Developed by: Omar Yaseen, Mariam Najajrah, Hanadi Yosuf | Supervised by: Dr. Amjad Shatnawi</p>
    </footer>

    <script src="js/main.js"></script>
    <script src="js/calculator.js"></script>
    <script src="js/visualization.js"></script>
</body>
</html>
